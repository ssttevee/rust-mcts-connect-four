{"version":3,"file":"mcts.js","sources":["../pkg/libc4.js","../web/worker/index.js"],"sourcesContent":["\nlet wasm;\n\nlet cachegetInt32Memory = null;\nfunction getInt32Memory() {\n    if (cachegetInt32Memory === null || cachegetInt32Memory.buffer !== wasm.memory.buffer) {\n        cachegetInt32Memory = new Int32Array(wasm.memory.buffer);\n    }\n    return cachegetInt32Memory;\n}\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nfunction getArrayU8FromWasm(ptr, len) {\n    return getUint8Memory().subarray(ptr / 1, ptr / 1 + len);\n}\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nlet cachegetUint32Memory = null;\nfunction getUint32Memory() {\n    if (cachegetUint32Memory === null || cachegetUint32Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint32Memory = new Uint32Array(wasm.memory.buffer);\n    }\n    return cachegetUint32Memory;\n}\n\nconst heap = new Array(32);\n\nheap.fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nfunction getArrayJsValueFromWasm(ptr, len) {\n    const mem = getUint32Memory();\n    const slice = mem.subarray(ptr / 4, ptr / 4 + len);\n    const result = [];\n    for (let i = 0; i < slice.length; i++) {\n        result.push(takeObject(slice[i]));\n    }\n    return result;\n}\n\nfunction _assertClass(instance, klass) {\n    if (!(instance instanceof klass)) {\n        throw new Error(`expected instance of ${klass.name}`);\n    }\n    return instance.ptr;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nfunction passArray8ToWasm(arg) {\n    const ptr = wasm.__wbindgen_malloc(arg.length * 1);\n    getUint8Memory().set(arg, ptr / 1);\n    WASM_VECTOR_LEN = arg.length;\n    return ptr;\n}\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction passArrayJsValueToWasm(array) {\n    const ptr = wasm.__wbindgen_malloc(array.length * 4);\n    const mem = getUint32Memory();\n    for (let i = 0; i < array.length; i++) {\n        mem[ptr / 4 + i] = addHeapObject(array[i]);\n    }\n    WASM_VECTOR_LEN = array.length;\n    return ptr;\n}\n\nlet cachedTextDecoder = new TextDecoder('utf-8');\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n/**\n*/\nexport const Token = Object.freeze({ Player1:0,Player2:1, });\n/**\n*/\nexport class Board {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Board.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        wasm.__wbg_board_free(ptr);\n    }\n    /**\n    * @param {number} col\n    * @param {number} row\n    * @returns {number}\n    */\n    token_at(col, row) {\n        const ret = wasm.board_token_at(this.ptr, col, row);\n        return ret === 2 ? undefined : ret;\n    }\n    /**\n    * @param {number} col\n    * @param {number} row\n    * @param {number} token\n    */\n    fill(col, row, token) {\n        wasm.board_fill(this.ptr, col, row, token);\n    }\n    /**\n    * @param {number} cols\n    * @param {number} rows\n    * @returns {Board}\n    */\n    constructor(cols, rows) {\n        const ret = wasm.board_new(cols, rows);\n        return Board.__wrap(ret);\n    }\n    /**\n    * @returns {number}\n    */\n    cols() {\n        const ret = wasm.board_cols(this.ptr);\n        return ret >>> 0;\n    }\n    /**\n    * @returns {number}\n    */\n    rows() {\n        const ret = wasm.board_rows(this.ptr);\n        return ret >>> 0;\n    }\n}\n/**\n*/\nexport class Game {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Game.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        wasm.__wbg_game_free(ptr);\n    }\n    /**\n    * @returns {boolean}\n    */\n    over() {\n        const ret = wasm.game_over(this.ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {number}\n    */\n    current_player() {\n        const ret = wasm.game_current_player(this.ptr);\n        return ret;\n    }\n    /**\n    * @returns {number}\n    */\n    cols() {\n        const ret = wasm.game_cols(this.ptr);\n        return ret >>> 0;\n    }\n    /**\n    * @returns {number}\n    */\n    rows() {\n        const ret = wasm.game_rows(this.ptr);\n        return ret >>> 0;\n    }\n    /**\n    * @returns {Uint8Array}\n    */\n    state() {\n        const retptr = 8;\n        const ret = wasm.game_state(retptr, this.ptr);\n        const memi32 = getInt32Memory();\n        const v0 = getArrayU8FromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n        wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 1);\n        return v0;\n    }\n    /**\n    * @param {number | undefined} cols\n    * @param {number | undefined} rows\n    * @param {number | undefined} win_length\n    * @returns {Game}\n    */\n    constructor(cols, rows, win_length) {\n        const ret = wasm.game_ctor(!isLikeNone(cols), isLikeNone(cols) ? 0 : cols, !isLikeNone(rows), isLikeNone(rows) ? 0 : rows, !isLikeNone(win_length), isLikeNone(win_length) ? 0 : win_length);\n        return Game.__wrap(ret);\n    }\n    /**\n    * @returns {any[]}\n    */\n    valid_moves() {\n        const retptr = 8;\n        const ret = wasm.game_valid_moves(retptr, this.ptr);\n        const memi32 = getInt32Memory();\n        const v0 = getArrayJsValueFromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n        wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 4);\n        return v0;\n    }\n    /**\n    * @returns {number}\n    */\n    winner() {\n        const ret = wasm.game_winner(this.ptr);\n        return ret === 2 ? undefined : ret;\n    }\n    /**\n    * @returns {any[]}\n    */\n    winner_cells() {\n        const retptr = 8;\n        const ret = wasm.game_winner_cells(retptr, this.ptr);\n        const memi32 = getInt32Memory();\n        let v0;\n        if (memi32[retptr / 4 + 0] !== 0) {\n            v0 = getArrayJsValueFromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n            wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 4);\n        }\n        return v0;\n    }\n    /**\n    * @param {number} col\n    * @returns {number}\n    */\n    drop(col) {\n        const ret = wasm.game_drop(this.ptr, col);\n        return ret >>> 0;\n    }\n    /**\n    * @returns {any}\n    */\n    board() {\n        const ret = wasm.game_board(this.ptr);\n        return takeObject(ret);\n    }\n}\n/**\n*/\nexport class MCTS {\n\n    static __wrap(ptr) {\n        const obj = Object.create(MCTS.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        wasm.__wbg_mcts_free(ptr);\n    }\n    /**\n    * @returns {MCTS}\n    */\n    constructor() {\n        const ret = wasm.mcts_new();\n        return MCTS.__wrap(ret);\n    }\n    /**\n    * @param {Game} game\n    * @returns {any[]}\n    */\n    simulate(game) {\n        const retptr = 8;\n        _assertClass(game, Game);\n        const ret = wasm.mcts_simulate(retptr, this.ptr, game.ptr);\n        const memi32 = getInt32Memory();\n        const v0 = getArrayJsValueFromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n        wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 4);\n        return v0;\n    }\n    /**\n    * @param {Game} game\n    * @param {number} duration\n    * @returns {any[]}\n    */\n    think(game, duration) {\n        const retptr = 8;\n        _assertClass(game, Game);\n        const ret = wasm.mcts_think(retptr, this.ptr, game.ptr, duration);\n        const memi32 = getInt32Memory();\n        const v0 = getArrayJsValueFromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n        wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 4);\n        return v0;\n    }\n    /**\n    * @param {Uint8Array} state\n    * @param {any[]} moves\n    * @returns {any[]}\n    */\n    move_weights(state, moves) {\n        const retptr = 8;\n        const ret = wasm.mcts_move_weights(retptr, this.ptr, passArray8ToWasm(state), WASM_VECTOR_LEN, passArrayJsValueToWasm(moves), WASM_VECTOR_LEN);\n        const memi32 = getInt32Memory();\n        const v0 = getArrayJsValueFromWasm(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1]).slice();\n        wasm.__wbindgen_free(memi32[retptr / 4 + 0], memi32[retptr / 4 + 1] * 4);\n        return v0;\n    }\n}\n\nfunction init(module) {\n    // if (typeof module === 'undefined') {\n    //     module = import.meta.url.replace(/\\.js$/, '_bg.wasm');\n    // }\n    let result;\n    const imports = {};\n    imports.wbg = {};\n    imports.wbg.__wbindgen_number_new = function(arg0) {\n        const ret = arg0;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_string_new = function(arg0, arg1) {\n        const ret = getStringFromWasm(arg0, arg1);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_json_parse = function(arg0, arg1) {\n        const ret = JSON.parse(getStringFromWasm(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_random_3d74d328ba8726a5 = function() {\n        const ret = Math.random();\n        return ret;\n    };\n    imports.wbg.__wbg_now_905b1ca2d46dea4e = function() {\n        const ret = Date.now();\n        return ret;\n    };\n    imports.wbg.__wbindgen_object_drop_ref = function(arg0) {\n        takeObject(arg0);\n    };\n    imports.wbg.__wbindgen_number_get = function(arg0, arg1) {\n        const obj = getObject(arg0);\n        if (typeof(obj) === 'number') return obj;\n        getUint8Memory()[arg1] = 1;\n        const ret = 0;\n        return ret;\n    };\n    imports.wbg.__wbindgen_throw = function(arg0, arg1) {\n        throw new Error(getStringFromWasm(arg0, arg1));\n    };\n    imports.wbg.__wbindgen_rethrow = function(arg0) {\n        throw takeObject(arg0);\n    };\n\n    if (module instanceof URL || typeof module === 'string' || module instanceof Request) {\n\n        const response = fetch(module);\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            result = WebAssembly.instantiateStreaming(response, imports)\n            .catch(e => {\n                console.warn(\"`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n                return response\n                .then(r => r.arrayBuffer())\n                .then(bytes => WebAssembly.instantiate(bytes, imports));\n            });\n        } else {\n            result = response\n            .then(r => r.arrayBuffer())\n            .then(bytes => WebAssembly.instantiate(bytes, imports));\n        }\n    } else {\n\n        result = WebAssembly.instantiate(module, imports)\n        .then(result => {\n            if (result instanceof WebAssembly.Instance) {\n                return { instance: result, module };\n            } else {\n                return result;\n            }\n        });\n    }\n    return result.then(({instance, module}) => {\n        wasm = instance.exports;\n        init.__wbindgen_wasm_module = module;\n\n        return wasm;\n    });\n}\n\nexport default init;\n\n","import init, { Game, MCTS } from '../../pkg/libc4';\n\nconst games = {};\n\nfunction randomString() {\n    return Math.random().toString().slice(2);\n}\n\nconst functions = {\n    newGame(opts) {\n        const { cols, rows, win_length } = opts || {};\n        let id;\n        while ((id = randomString()) && id in games) {}\n        const game = games[id] = new Game(cols, rows, win_length);\n\n        return {\n            id,\n            cols: game.cols(),\n            rows: game.rows(),\n            moves: game.valid_moves(),\n            board: game.board(),\n        };\n    },\n\n    freeGame({ gameId }) {\n        games[gameId].free();\n        delete games[gameId];\n    },\n    \n    drop({ gameId, column }) {\n        if (!(gameId in games)) {\n            throw new Error('game not found');\n        }\n    \n        const game = games[gameId];\n        const row = game.drop(column);\n        return {\n            cell: [column, row],\n            over: game.over(),\n            cells: game.winner_cells(),\n            moves: game.valid_moves(),\n            board: game.board(),\n        }\n    },\n\n    think({ gameId, duration = 1000 }) {\n        if (!(gameId in games)) {\n            throw new Error('game not found');\n        }\n\n        const game = games[gameId];\n        self.mcts.think(game, duration);\n\n        const moves = game.valid_moves();\n        const weights = self.mcts.move_weights(game.state(), moves);\n        return moves.map((move, i) => [move, weights[i]]);\n    }\n};\n\nonmessage = async (event) => {\n    const { id, name, payload } = event.data;\n\n    try {\n        postMessage({ id, result: await functions[name](payload) });\n    } catch (error) {\n        postMessage({ id, error });\n    }\n}\n\ninit('mcts_bg.wasm').then(() => (self.mcts = new MCTS(), postMessage({ ready: true })), (error) => postMessage({ error }))\n"],"names":[],"mappings":"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"}